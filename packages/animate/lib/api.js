!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).animate={})}(this,(function(t){"use strict";const e=t=>[].concat(...t),i=t=>"object"==typeof t&&!Array.isArray(t)&&"function"!=typeof t,s=(t,e)=>{let i,s,n=Object.keys(t),a={};for(let r=0,o=n.length;r<o;r++)i=n[r],s=t[i],a[i]=e(s,i,t);return a},n=t=>""+t,a=t=>{let e=parseFloat(t);return n(t).replace(n(e),"")},r=t=>n(t).trim(),o=t=>Array.isArray(t)||"string"==typeof t?("string"==typeof t&&(t=t.split(/\s+/)),t):[t],l=t=>Array.isArray(t)||"string"==typeof t?Boolean(t.length):null!=t&&null!=t&&!Number.isNaN(t),u=t=>"-"==(t=t.replace(/([A-Z])/g,(t=>`-${t.toLowerCase()}`))).charAt(0)?t.substr(1):t,h=t=>t.includes("--")?t:`${t}`.replace(/-([a-z])/g,((t,e)=>e.toUpperCase())),p=(t,e)=>{let i=[...t],s={...e};for(;i.length;){let{[i.pop()]:t,...e}=s;s=e}return s},c=(t,e)=>{let i=[...t],s={};for(let t of i)l(e[t])&&(s[t]=e[t]);return s},m=(...t)=>{let e=0,i=[],s=(t=t.map((t=>{let i=o(t),s=i.length;return s>e&&(e=s),i}))).length;for(let n=0;n<e;n++){i[n]=[];for(let e=0;e<s;e++){let s=t[e][n];l(s)&&(i[n][e]=s)}}return i},f=t=>"string"==typeof t?t.includes("%")?parseFloat(t)/100:"from"==t?0:"to"==t?1:parseFloat(t):t,d=t=>{let e=new Set,i=Object.keys(t),s=i.length;for(let n=0;n<s;n++){let s=""+i[n],a=t[s],r=s.split(","),o=r.length;for(let t=0;t<o;t++){let i=f(r[t]);e.add({...a,offset:i})}}return[...e].sort(((t,e)=>t.offset-e.offset))};class g{constructor(t){this.map=new Map(t)}getMap(){return this.map}get(t){return this.map.get(t)}keys(){return Array.from(this.map.keys())}values(){return Array.from(this.map.values())}set(t,e){return this.map.set(t,e),this}add(t){let e=this.size;return this.set(e,t),this}get size(){return this.map.size}get length(){return this.map.size}last(t=1){let e=this.keys()[this.size-t];return this.get(e)}delete(t){return this.map.delete(t)}remove(t){return this.map.delete(t),this}clear(){return this.map.clear(),this}has(t){return this.map.has(t)}entries(){return this.map.entries()}forEach(t,e){return this.map.forEach(t,e),this}[Symbol.iterator](){return this.entries()}}const y=(t="")=>e=>"string"==typeof e?e:`${e}${t}`,b=y(),E=y("px"),S=y("deg"),O=t=>e=>l(e)?o(e).map((e=>{if("number"!=typeof e&&"string"!=typeof e)return e;let i=Number(e),s=Number.isNaN(i)?"string"==typeof e?e.trim():e:i;return t(s)})):[],A=(t,e)=>o(t).map(O(e)),k=O(b),w=O(E),M=O(S),P=new g,C=(t="transparent")=>{if(t=t.trim(),P.has(t))return P.get(t);if(!CSS.supports("background-color",t))return t;let e=document.createElement("div");e.style.backgroundColor=t,document.body.appendChild(e);let{backgroundColor:i}=getComputedStyle(e);e.remove();let s=/\(([^)]+)\)?/.exec(i)?.[1].split(","),n=(3==s.length?[...s,"1"]:s).map((t=>parseFloat(t)));return P.set(t,n),n},x={translate3d:["--translate3d0","--translate3d1","--translate3d2"],translate:["--translate0","--translate1"],translateX:"--translateX",translateY:"--translateY",translateZ:"--translateZ",rotate3d:["--rotate3d0","--rotate3d1","--rotate3d2","--rotate3d3"],rotate:"--rotate",rotateX:"--rotateX",rotateY:"--rotateY",rotateZ:"--rotateZ",scale3d:["--scale3d0","--scale3d1","--scale3d2"],scale:["--scale0","--scale1"],scaleX:"--scaleX",scaleY:"--scaleY",scaleZ:"--scaleZ",skew:["--skew0","--skew1"],skewX:"--skewX",skewY:"--skewY",perspective:"--perspective"},v="registerProperty"in CSS,D=Object.keys(x),T=(t={})=>Object.keys(t).filter((t=>D.includes(t))).map((t=>{if(!v)return"";let e=[].concat(x[t]);return e.forEach((t=>{if(globalThis.RegisteredCSSVars?.[t])return;let e={name:t,inherits:!1};/translate|perspective/i.test(t)?CSS.registerProperty({...e,syntax:"<length-percentage>",initialValue:"0px"}):/rotate3d3|skew/i.test(t)?CSS.registerProperty({...e,syntax:"<angle>",initialValue:"0deg"}):/scale|rotate3d/i.test(t)?CSS.registerProperty({...e,syntax:"<number>",initialValue:/rotate3d/i.test(t)?0:1}):/rotate/i.test(t)&&CSS.registerProperty({...e,syntax:"<angle>",initialValue:"0deg"}),globalThis.RegisteredCSSVars??={},globalThis.RegisteredCSSVars[t]=!0})),`${t}(${e.map((t=>`var(${t})`))})`})).join(" "),N=(t={})=>{let e={};return D.forEach((i=>{if(!(i in t))return;let s=[].concat(t[i]).filter((t=>l(t))).map((t=>"string"==typeof t&&/\s/.test(t.trim())?t.split(/\s+/):t));if(0==s.length)return;let n=[].concat(x[i]),a=s.every((t=>Array.isArray(t))),r=1==s.length&&"scale"==i;n.forEach(((t,i)=>{let n=r?0:i,o=a?m(...s)[n]:s;if(l(o)){let i=t;/translate|perspective/i.test(i)?o=w(o):/rotate3d3|skew/i.test(i)?o=M(o):/scale|rotate3d/i.test(i)||/rotate/i.test(i)&&(o=M(o)),e[t]=o}}))})),e},I=.1,F="function"==typeof Float32Array,j=(t,e)=>1-3*e+3*t,z=(t,e)=>3*e-6*t,q=t=>3*t,R=(t,e,i)=>((j(e,i)*t+z(e,i))*t+q(e))*t,L=(t,e,i)=>3*j(e,i)*t*t+2*z(e,i)*t+q(e),_=(t,e,i,s)=>{if(!(0<=t&&t<=1&&0<=i&&i<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&i===s)return t=>t;for(var n=F?new Float32Array(11):new Array(11),a=0;a<11;++a)n[a]=R(a*I,t,i);const r=e=>{let s=0,a=1;for(;10!==a&&n[a]<=e;++a)s+=I;--a;let r=s+(e-n[a])/(n[a+1]-n[a])*I,o=L(r,t,i);return o>=.001?((t,e,i,s)=>{for(var n=0;n<4;++n){let n=L(e,i,s);if(0===n)return e;e-=(R(e,i,s)-t)/n}return e})(e,r,t,i):0===o?r:((t,e,i,s,n)=>{let a,r,o=0;do{r=e+(i-e)/2,a=R(r,s,n)-t,a>0?i=r:e=r}while(Math.abs(a)>1e-7&&++o<10);return r})(e,s,s+I,t,i)};return t=>0===t||1===t?t:R(r(t),e,s)},K=(t,e,i)=>Math.min(Math.max(t,e),i),V=t=>Math.pow(t,2),U=t=>Math.pow(t,3),Y=t=>Math.pow(t,4),X=t=>Math.pow(t,5),G=t=>Math.pow(t,6),Z=t=>1-Math.cos(t*Math.PI/2),$=t=>1-Math.sqrt(1-t*t),Q=t=>t*t*(3*t-2),B=t=>{let e,i=4;for(;t<((e=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)},W=(t,e=[])=>{let[i=1,s=.5]=e;const n=K(i,1,10),a=K(s,.1,2);return 0===t||1===t?t:-n*Math.pow(2,10*(t-1))*Math.sin((t-1-a/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/a)},H=(t,e=[],i)=>{let[s=1,n=100,a=10,r=0]=e;s=K(s,.1,1e3),n=K(n,.1,1e3),a=K(a,.1,1e3),r=K(r,.1,1e3);const o=Math.sqrt(n/s),l=a/(2*Math.sqrt(n*s)),u=l<1?o*Math.sqrt(1-l*l):0,h=l<1?(l*o-r)/u:-r+o;let p=i?i*t/1e3:t;return p=l<1?Math.exp(-p*l*o)*(1*Math.cos(u*p)+h*Math.sin(u*p)):(1+h*p)*Math.exp(-p*o),0===t||1===t?t:1-p},J=new Map,tt=(t="spring")=>{if(J.has(t))return J.get(t);const e="function"==typeof t?t:ut(t),i="function"==typeof t?[]:ht(t),s=1/6;let n=0,a=0,r=0;for(;++r<1e4;)if(n+=s,1===e(n,i,null)){if(a++,a>=16)break}else a=0;const o=n*s*1e3;return J.set(t,o),o},et=(t,e=[])=>{let[i=10,s]=e;return("start"==s?Math.ceil:Math.floor)(K(t,0,1)*i)/i},it=(t,e=[])=>{let[i,s,n,a]=e;return _(i,s,n,a)(t)},st=_(.42,0,1,1),nt=t=>(e,i=[],s)=>1-t(1-e,i,s),at=t=>(e,i=[],s)=>e<.5?t(2*e,i,s)/2:1-t(-2*e+2,i,s)/2,rt=t=>(e,i=[],s)=>e<.5?(1-t(1-2*e,i,s))/2:(t(2*e-1,i,s)+1)/2,ot={steps:et,"step-start":t=>et(t,[1,"start"]),"step-end":t=>et(t,[1,"end"]),linear:t=>t,"cubic-bezier":it,ease:t=>it(t,[.25,.1,.25,1]),in:st,out:nt(st),"in-out":at(st),"out-in":rt(st),"in-quad":V,"out-quad":nt(V),"in-out-quad":at(V),"out-in-quad":rt(V),"in-cubic":U,"out-cubic":nt(U),"in-out-cubic":at(U),"out-in-cubic":rt(U),"in-quart":Y,"out-quart":nt(Y),"in-out-quart":at(Y),"out-in-quart":rt(Y),"in-quint":X,"out-quint":nt(X),"in-out-quint":at(X),"out-in-quint":rt(X),"in-expo":G,"out-expo":nt(G),"in-out-expo":at(G),"out-in-expo":rt(G),"in-sine":Z,"out-sine":nt(Z),"in-out-sine":at(Z),"out-in-sine":rt(Z),"in-circ":$,"out-circ":nt($),"in-out-circ":at($),"out-in-circ":rt($),"in-back":Q,"out-back":nt(Q),"in-out-back":at(Q),"out-in-back":rt(Q),"in-bounce":B,"out-bounce":nt(B),"in-out-bounce":at(B),"out-in-bounce":rt(B),"in-elastic":W,"out-elastic":nt(W),"in-out-elastic":at(W),"out-in-elastic":rt(W),spring:H,"spring-in":H,"spring-out":nt(H),"spring-in-out":at(H),"spring-out-in":rt(H)};t.EasingFunctionKeys=Object.keys(ot);const lt=t=>u(t).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim(),ut=e=>{let i=lt(n(e));return t.EasingFunctionKeys.includes(i)?ot[i]:null},ht=t=>{const e=/(\(|\s)([^)]+)\)?/.exec(n(t));return e?e[2].split(",").map((t=>{let e=parseFloat(t);return Number.isNaN(e)?t.trim():e})):[]},pt=(t,e,i)=>e+(i-e)*t,ct=(t,e)=>Math.round(t*10**e)/10**e,mt=(t,e,i=3)=>{let s=e.length-1,n=K(Math.floor(t*s),0,s-1),a=e[n],r=e[n+1];return ct(pt((t-n/s)*s,a,r),i)},ft=t=>{let e=parseFloat(t);return"number"==typeof e&&!Number.isNaN(e)},dt=(t,e)=>{t=K(t,0,1);let i=e.length-1;return e[Math.round(t*i)]},gt=(t,e,i=3)=>{let s="";return ft(e[0])&&(s=a(e[0])),mt(t,e.map((t=>"number"==typeof t?t:parseFloat(t))),i)+s},yt=(t,e,i=3)=>m(...e.map((t=>C(t)))).map(((e,s)=>{let n=mt(t,e);return s<3?Math.round(n):ct(n,i)})),bt=t=>r(t).replace(/(\d|\)|\w)\s/g,(t=>t[0]+"__")).split("__").map(r).filter(l),Et=(t,e,i=3)=>e.every((t=>"number"==typeof t))?mt(t,e,i):e.every((t=>CSS.supports("color",n(t))))?`rgba(${yt(t,e,i)})`:e.some((t=>"string"==typeof t))?e.some((t=>/(\d|\)|\w)\s/.test(r(t))))?m(...e.map(bt)).map((e=>Et(t,e,i))).join(" "):e.every((t=>ft(t)))?gt(t,e,i):dt(t,e):void 0,St=(t={})=>{let e="string"==typeof t||"function"==typeof t,{easing:i="spring(1, 100, 10, 0)",numPoints:s=100,decimal:n=3,duration:a}=e?{easing:t}:t;return{easing:i,numPoints:s,decimal:n,duration:a}},Ot=new Map,At=({easing:t,numPoints:e,duration:i}={})=>{const s=[],n=`${t}${e}`;if(Ot.has(n))return Ot.get(n);const a="function"==typeof t?t:ut(t),r="function"==typeof t?[]:ht(t);for(let t=0;t<e;t++)s[t]=a(t/(e-1),r,i);return Ot.set(n,s),s},kt=(t={})=>{if("string"==typeof t.easing){let e=lt(t.easing);/(spring|spring-in)$/i.test(e)&&(t.duration=tt(t.easing))}},wt=(t,e={})=>{let i=St(e);return kt(i),At(i).map((e=>Et(e,t,i.decimal)))},Mt=(t={})=>{let{easing:e,numPoints:i,decimal:n,duration:a,...r}=t,o={easing:e,numPoints:i,decimal:n,duration:a};kt(o);let u=s(r,(t=>wt(t,o))),h={};return l(a)?h={duration:a}:l(o.duration)&&(h={duration:o.duration}),Object.assign({},u,h)},Pt={translate:t=>A(t,E),translate3d:t=>A(t,E),translateX:t=>w(t),translateY:t=>w(t),translateZ:t=>w(t),rotate:t=>A(t,S),rotate3d:t=>A(t,b),rotateX:t=>M(t),rotateY:t=>M(t),rotateZ:t=>M(t),scale:t=>A(t,b),scale3d:t=>A(t,b),scaleX:t=>k(t),scaleY:t=>k(t),scaleZ:t=>k(t),skew:t=>A(t,S),skewX:t=>M(t),skewY:t=>M(t),perspective:t=>w(t)},Ct=Object.keys(Pt),xt=t=>{let e,i,s=Object.keys(t),n={};for(let a=0,r=s.length;a<r;a++)e=h(s[a]),i=t[s[a]],n[e]=i;return n},vt=(t,e)=>{let i="",s=t.length;for(let n=0;n<s;n++){let s=t[n],a=e[n];l(a)&&(i+=`${s}(${Array.isArray(a)?a.join(", "):a}) `)}return i.trim()},Dt=["margin","padding","size","width","height","left","right","top","bottom","radius","gap","basis","inset","outline-offset","translate","perspective","thickness","position","distance","spacing"].map(h).join("|"),Tt=(t,e)=>(e=e??Math.max(...t.map((t=>t.length))),t.map((t=>{let i=t.length;return t.every((t=>Array.isArray(t)))?m(...Tt(m(...t),e)):i!==e?Array.from(Array(e),((s,n)=>{let a=1==i?Array(2).fill(t[0]):t;return gt(n/(e-1),a)})):t}))),Nt=t=>{let e,i,a=xt(t);if(v)e=Object.assign({},N(a),p(D,a));else{let t=Object.keys(a).filter((t=>Ct.includes(t))),s=t.map((t=>Pt[t](a[t])));s=Tt(s),i=m(...s).filter(l).map((e=>vt(t,e))),e=p(Ct,a)}return e=s(e,((t,e)=>{let i;if(!/color|shadow/i.test(e)){let s=/rotate/i.test(e),n=new RegExp(Dt,"i").test(e)||CSS.supports(u(e),"1px");if(s||n)return s?i=M:n&&(i=w),i(t).map((t=>{let e=r(t).split(/\s+/);return i(e).join(" ")}))}return[].concat(t).map(n)})),Object.assign({},l(i)?{transform:i}:null,e)},It=t=>t.map((t=>{let e=xt(t);if(v)return{rest:Object.assign({},N(e),p(D,e)),transformFunctions:null};let{translate:i,translate3d:s,translateX:n,translateY:a,translateZ:r,rotate:o,rotate3d:l,rotateX:u,rotateY:h,rotateZ:c,scale:m,scale3d:f,scaleX:d,scaleY:g,scaleZ:y,skew:b,skewX:E,skewY:S,perspective:O,...A}=e;return i=w(i),s=w(s),n=w(n)[0],a=w(a)[0],r=w(r)[0],o=M(o),l=k(l),u=M(u)[0],h=M(h)[0],c=M(c)[0],m=k(m),f=k(f),d=k(d)[0],g=k(g)[0],y=k(y)[0],b=M(b),E=M(E)[0],S=M(S)[0],O=w(O)[0],{rest:A,transformFunctions:[s,i,n,a,r,l,o,u,h,c,f,m,d,g,y,b,E,S,O]}})).map((({rest:t,transformFunctions:e})=>{let i=v?null:vt(Ct,e);return t=s(t,((t,e)=>{let i;if(t=n(t),!/color|shadow/i.test(e)){let s=/rotate/i.test(e),n=new RegExp(Dt,"i").test(e);if(s||n)return s?i=M:n&&(i=w),i(t).join(" ")}return t})),Object.assign({},l(i)?{transform:i}:null,t)})),Ft=({callback:t=(()=>{}),scope:e=null,name:i="event"})=>({callback:t,scope:e,name:i});class jt extends g{constructor(t="event"){super(),this.name=t}}const zt=t=>"object"==typeof t&&!Array.isArray(t)&&"function"!=typeof t;class qt extends g{constructor(){super()}getEvent(t){let e=this.get(t);return e instanceof jt?e:(this.set(t,new jt(t)),this.get(t))}newListener(t,e,i){let s=this.getEvent(t);return s.add(Ft({name:t,callback:e,scope:i})),s}on(t,e,i){if(null==t||null==t)return this;"string"==typeof t&&(t=t.trim().split(/\s+/));let s,n,a=zt(t),r=a?e:i;return a||(n=e),Object.keys(t).forEach((e=>{s=a?e:t[e],a&&(n=t[e]),this.newListener(s,n,r)}),this),this}removeListener(t,e,i){let s=this.get(t);if(s instanceof jt&&e){let n=Ft({name:t,callback:e,scope:i});s.forEach(((t,e)=>{if(t.callback===n.callback&&t.scope===n.scope)return s.remove(e)}))}return s}off(t,e,i){if(null==t||null==t)return this;"string"==typeof t&&(t=t.trim().split(/\s+/));let s,n,a=zt(t),r=a?e:i;return a||(n=e),Object.keys(t).forEach((e=>{s=a?e:t[e],a&&(n=t[e]),"function"==typeof n?this.removeListener(s,n,r):this.remove(s)}),this),this}once(t,e,i){if(null==t||null==t)return this;"string"==typeof t&&(t=t.trim().split(/\s+/));let s=zt(t);return Object.keys(t).forEach((n=>{let a=s?n:t[n],r=s?t[n]:e,o=s?e:i,l=(...t)=>{r.apply(o,t),this.removeListener(a,l,o)};this.newListener(a,l,o)}),this),this}emit(t,...e){return null==t||null==t||("string"==typeof t&&(t=t.trim().split(/\s+/)),t.forEach((t=>{let i=this.get(t);i instanceof jt&&i.forEach((t=>{let{callback:i,scope:s}=t;i.apply(s,e)}))}),this)),this}clear(){return((t,e,...i)=>{t.forEach((t=>{t[e](...i)}))})(this,"clear"),super.clear(),this}}const Rt=t=>"string"==typeof t?Array.from(document.querySelectorAll(t)):[t],Lt=t=>Array.isArray(t)?e(t.map(Lt)):"string"==typeof t||t instanceof Node?Rt(t):t instanceof NodeList||t instanceof HTMLCollection?Array.from(t):[],_t=(t,e,i)=>"function"==typeof t?t.apply(i,e):t,Kt=(t,e,i)=>s(t,(t=>_t(t,e,i))),Vt={in:"ease-in",out:"ease-out","in-out":"ease-in-out","in-sine":"cubic-bezier(0.47, 0, 0.745, 0.715)","out-sine":"cubic-bezier(0.39, 0.575, 0.565, 1)","in-out-sine":"cubic-bezier(0.445, 0.05, 0.55, 0.95)","in-quad":"cubic-bezier(0.55, 0.085, 0.68, 0.53)","out-quad":"cubic-bezier(0.25, 0.46, 0.45, 0.94)","in-out-quad":"cubic-bezier(0.455, 0.03, 0.515, 0.955)","in-cubic":"cubic-bezier(0.55, 0.055, 0.675, 0.19)","out-cubic":"cubic-bezier(0.215, 0.61, 0.355, 1)","in-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1)","in-quart":"cubic-bezier(0.895, 0.03, 0.685, 0.22)","out-quart":"cubic-bezier(0.165, 0.84, 0.44, 1)","in-out-quart":"cubic-bezier(0.77, 0, 0.175, 1)","in-quint":"cubic-bezier(0.755, 0.05, 0.855, 0.06)","out-quint":"cubic-bezier(0.23, 1, 0.32, 1)","in-out-quint":"cubic-bezier(0.86, 0, 0.07, 1)","in-expo":"cubic-bezier(0.95, 0.05, 0.795, 0.035)","out-expo":"cubic-bezier(0.19, 1, 0.22, 1)","in-out-expo":"cubic-bezier(1, 0, 0, 1)","in-circ":"cubic-bezier(0.6, 0.04, 0.98, 0.335)","out-circ":"cubic-bezier(0.075, 0.82, 0.165, 1)","in-out-circ":"cubic-bezier(0.785, 0.135, 0.15, 0.86)","in-back":"cubic-bezier(0.6, -0.28, 0.735, 0.045)","out-back":"cubic-bezier(0.175, 0.885, 0.32, 1.275)","in-out-back":"cubic-bezier(0.68, -0.55, 0.265, 1.55)"},Ut=Object.keys(Vt),Yt=(t="ease")=>{let e=u(t).replace(/^ease-/,"");return Ut.includes(e)?Vt[e]:t},Xt={keyframes:[],offset:[],loop:1,delay:0,speed:1,endDelay:0,easing:"ease",timelineOffset:0,autoplay:!0,duration:1e3,persist:!0,fillMode:"none",direction:"normal",padEndDelay:!1,timeline:document.timeline,extend:{}},Gt=t=>{let{options:e,...i}=t,s=e instanceof Wt?e.options:Array.isArray(e)?e?.[0]?.options:e;return Object.assign({},s,i)},Zt=["easing","loop","endDelay","duration","speed","delay","timelineOffset","direction","extend","fillMode","composite"],$t=["keyframes","padEndDelay","persist","onfinish","oncancel","autoplay","target","targets","timeline"],Qt=[...Zt,...$t],Bt=class{constructor(t={}){this.options={},this.initialOptions={},this.properties={},this.totalDuration=0,this.totalDurationOptions={},this.maxDuration=0,this.minDelay=1/0,this.maxSpeed=1/0,this.maxEndDelay=0,this.timelineOffset=0,this.emitter=new qt,this.targets=new g,this.targetIndexes=new WeakMap,this.keyframeEffects=new WeakMap,this.computedOptions=new WeakMap,this.animations=new WeakMap,this.computedKeyframes=new WeakMap,this.loop=this.loop.bind(this),this.onVisibilityChange=this.onVisibilityChange.bind(this),this.on("error",console.error),this.updateOptions(t),this.mainAnimation&&(this.visibilityPlayState=this.getPlayState(),Bt.pauseOnPageHidden&&document.addEventListener("visibilitychange",this.onVisibilityChange,!1)),this.newPromise()}static requestFrame(t=0){let e=1e3/Bt.FRAME_RATE,i=t-Bt.FRAME_START_TIME;i>e&&(Bt.FRAME_START_TIME=t-i%e,Bt.RUNNING.forEach((t=>{t.emitter.getEvent("update").length<=0?t.stopLoop():t.loop()}))),Bt.RUNNING.size>0?Bt.animationFrame=window.requestAnimationFrame(Bt.requestFrame):Bt.cancelFrame()}static cancelFrame(){window.cancelAnimationFrame(Bt.animationFrame),Bt.animationFrame=null}loop(){this.emit("update",this.getProgress(),this)}stopLoop(){Bt.RUNNING.delete(this)}onVisibilityChange(){document.hidden?(this.visibilityPlayState=this.getPlayState(),this.is("running")&&(this.loop(),this.pause())):"running"==this.visibilityPlayState&&this.is("paused")&&this.play()}newPromise(){return this.promise=new Promise(((t,e)=>{this.emitter?.once?.("finish",(()=>t([this]))),this.emitter?.once?.("error",(t=>e(t)))})),this.promise}then(t,e){return t=t?.bind(this),e=e?.bind(this),this.promise?.then?.(t,e),this}catch(t){return t=t?.bind(this),this.promise?.catch?.(t),this}finally(t){return t=t?.bind(this),this.promise?.finally?.(t),this}allAnimations(t){return this.targets.forEach((e=>{let i=this.keyframeEffects.get(e),s=this.animations.get(i);return t(s,e)})),this}all(t){return this.mainAnimation&&t(this.mainAnimation,this.mainElement),this.allAnimations(t),this}beginEvent(){0==this.getProgress()&&this.emit("begin",this)}play(){let t=this.getPlayState();return this.beginEvent(),this.all((t=>t.play())),this.emit("play",t,this),this.emit("playstate-change",t,this),this.loop(),Bt.RUNNING.add(this),Bt.requestFrame(),this}pause(){let t=this.getPlayState();return this.all((t=>t.pause())),this.emit("pause",t,this),this.emit("playstate-change",t,this),this.stopLoop(),this}reverse(){return this.all((t=>t.reverse())),this}reset(){return this.setProgress(0),this.options.autoplay?this.play():this.pause(),this}commitStyles(){return this.all((t=>t?.commitStyles())),this}persist(){return this.targets.forEach((t=>{let e=this.computedKeyframes.get(t);Array.isArray(e)&&e.length?s(e[e.length-1],((e,i)=>{t.style.setProperty(i,e)})):s(e,((e,i)=>{!e.length||t.style.setProperty(i,e[e.length-1])}))})),this}cancel(){return this.all((t=>t.cancel())),this}finish(){return this.all((t=>t.finish())),this}stop(){this.cancel(),this.stopLoop(),document.removeEventListener("visibilitychange",this.onVisibilityChange,!1),this.targets.forEach((t=>this.removeTarget(t))),this.emit("stop"),this.emitter.clear(),this.mainkeyframeEffect=null,this.mainAnimation=null,this.mainElement?.remove?.(),this.mainElement=null,this.promise=null,this.computedOptions=null,this.animations=null,this.keyframeEffects=null,this.emitter=null,this.targets=null,this.options=null,this.properties=null}getAnimation(t){let e=this.keyframeEffects.get(t);return this.animations.get(e)}getTiming(t){return{...this.computedOptions.get(t)??{},...this.keyframeEffects.get(t).getTiming?.()??{}}}getCurrentTime(){return this.mainAnimation.currentTime}getProgress(){return this.getCurrentTime()/this.totalDuration*100}getSpeed(){return this.mainAnimation.playbackRate}getPlayState(){return this.mainAnimation.playState}is(t){return this.getPlayState()==t}setCurrentTime(t){return this.all((e=>e.currentTime=t)),this.emit("update",this.getProgress()),this}setProgress(t){let e=t/100*this.totalDuration;return this.setCurrentTime(e),this}setSpeed(t=1){return this.maxSpeed=t,this.all((e=>{e.updatePlaybackRate?e.updatePlaybackRate(t):e.playbackRate=t})),this}createArrayOfComputedOptions(t,e){let i=[],s=t=>Object.assign({easing:t("easing"),iterations:t("loop"),direction:t("direction"),endDelay:t("endDelay"),duration:t("duration"),speed:t("speed"),delay:t("delay"),timelineOffset:t("timelineOffset"),keyframes:t("keyframes"),fill:t("fillMode"),composite:t("composite")},t("extend")??{});if(0==this.targets.size){let{delay:e,duration:i,iterations:n,endDelay:a,speed:r,timelineOffset:o}=s((e=>{let i=t[e]??this.options[e]??Xt[e];return"function"!=typeof i?i:Xt[e]}));o=Number(o),n=Number(n),i=Number(i),a=Number(a),r=Number(r),e=Number(e),this.timelineOffset=o,this.minDelay=e,this.maxSpeed=r,this.maxDuration=i,this.maxEndDelay=a,this.totalDuration=e+o+i*n+a,this.totalDurationOptions={delay:e,duration:i,iterations:n,endDelay:a,speed:r,timelineOffset:o,totalDuration:this.totalDuration}}return this.targets.forEach(((n,a)=>{let r=this.computedOptions.get(n)??{},o=s((e=>{let i=e;return"loop"==e&&(i="iterations"),"fillMode"==e&&(i="fill"),t[e]??r[i]??this.options[e]??Xt[e]})),l=Kt(o,[a,e,n],this);if("string"==typeof l.easing||Array.isArray(l.easing)){let{easing:t}=l;l.easing=Array.isArray(t)?t.map((t=>Yt(t))):Yt(t)}!0===l.iterations&&(l.iterations=1/0);let{timelineOffset:u,speed:h,endDelay:p,delay:c,duration:m,iterations:f,...d}=l;u=Number(u),f=Number(f),m=Number(m),p=Number(p),h=Number(h),c=Number(c)+u,this.timelineOffset=u??this.timelineOffset,this.minDelay>c&&(this.minDelay=c),this.maxSpeed>h&&(this.maxSpeed=h),this.maxDuration<m&&(this.maxDuration=m),this.maxEndDelay<p&&(this.maxEndDelay=p);let g=c+u+m*f+p;this.totalDuration<g&&(this.totalDuration=g,this.totalDurationOptions={delay:c,duration:m,totalDuration:g,iterations:f,endDelay:p,speed:h,timelineOffset:u}),i[a]={...d,speed:h,tempDurations:g,endDelay:p,delay:c,duration:m,iterations:f,timelineOffset:u}}),this),i}createAnimations(t,e){let{arrOfComputedOptions:n,padEndDelay:a,oldCSSProperties:r,onfinish:o,oncancel:u,persist:h,timeline:c}=t;this.targets.forEach(((t,m)=>{let g,{speed:y,keyframes:b,tempDurations:E,timelineOffset:S,...O}=n[m];a&&0==O.endDelay&&Math.abs(O.iterations)!=Math.abs(1/0)&&(O.endDelay=this.totalDuration-E);let A,k,w=b;i(w)&&(w=d(w));let M,P,C=this.computedKeyframes.get(t)??{},D="transform"in this.properties?C:p(["transform"],C),N=Object.assign({},r,D),I=s(N,((t,e)=>this.properties[e]??t));if(k=l(w)?w:I,Array.isArray(k))A=k.map((t=>{let{easing:e,offset:i,...s}=p(["speed","loop"],t);return Object.assign({},s,"string"==typeof e?{easing:Yt(e)}:null,"string"==typeof i||"number"==typeof i?{offset:f(i)}:null)})),g=T(x),A=It(A),h&&A.length&&s(A[A.length-1],((e,i)=>{t.style.setProperty(i,e)}));else{let i=p(["keyframes"],k),{offset:n,...a}=Kt(i,[m,e,t],this);g=T(xt(a)),a=Nt(a);let r=n;A=Object.assign({},a,l(r)?{offset:r.map(f)}:null),h&&s(a,((e,i)=>{!e.length||t.style.setProperty(i,e[e.length-1])}))}this.keyframeEffects.has(t)?(P=this.keyframeEffects.get(t),M=this.animations.get(P),P?.setKeyframes?.(A),P?.updateTiming?.(O)):(P=new KeyframeEffect(t,A,O),M=new Animation(P,c),this.keyframeEffects.set(t,P),this.animations.set(P,M)),M.updatePlaybackRate?M.updatePlaybackRate(y):M.playbackRate=y,M.onfinish=()=>{"function"==typeof o&&o.call(this,t,m,e,M)},M.oncancel=()=>{"function"==typeof u&&u.call(this,t,m,e,M)},v&&Object.assign(t.style,{transform:g}),this.computedOptions.set(t,O),this.computedKeyframes.set(t,A)}))}updateOptions(t={}){try{let e=Gt(t);this.initialOptions=e,this.options=Object.assign({},Xt,this.options,e);let{padEndDelay:i,autoplay:s,target:n,targets:a,timeline:r,persist:o,onfinish:l,oncancel:u,...h}=p(Zt,this.options);this.properties=p(Qt,e);let c=this.targets.values(),m=[...new Set([...c,...Lt(a),...Lt(n)])];this.targets.clear(),m.forEach(((t,e)=>{this.targets.set(e,t),this.targetIndexes.set(t,e)}));let f=this.targets.size,d=this.createArrayOfComputedOptions(e,f);if(this.createAnimations({arrOfComputedOptions:d,padEndDelay:i,oldCSSProperties:h,onfinish:l,oncancel:u,persist:o,timeline:r},f),this.mainAnimation?(this.mainkeyframeEffect?.updateTiming?.({duration:this.totalDuration}),(!this.mainkeyframeEffect.setKeyframes||!this.mainkeyframeEffect.updateTiming)&&console.warn("[Animate - @okikio/animate] `KeyframeEffect.setKeyframes` and/or `KeyframeEffect.updateTiming` are not supported in this browser.")):(this.mainkeyframeEffect=new KeyframeEffect(this.mainElement,null,{duration:this.totalDuration}),this.mainAnimation=new Animation(this.mainkeyframeEffect,r)),this.mainAnimation.updatePlaybackRate?this.mainAnimation.updatePlaybackRate(this.maxSpeed):this.mainAnimation.playbackRate=this.maxSpeed,this.mainAnimation.onfinish=()=>{if(this.mainAnimation){let t=this.getPlayState();this.emit("playstate-change",t,this),this.loop(),this.stopLoop()}this.emit("finish",this)},this.mainAnimation.oncancel=()=>{if(this.mainAnimation){let t=this.getPlayState();this.emit("playstate-change",t,this),this.loop(),this.stopLoop()}this.emit("cancel",this)},s){let t=window.setTimeout((()=>{this.emit("begin",this);let e=this.getPlayState();this.emit("playstate-change",e,this),t=window.clearTimeout(t)}),0);this.play()}else this.pause()}catch(t){this.emit("error",t)}}add(t){let e=this.getProgress(),i=this.is("running"),s=this.is("paused");return this.updateOptions({target:t}),this.setProgress(e),i?this.play():s&&this.pause(),this}removeTarget(t){let e=this.keyframeEffects.get(t);this.animations.delete(e),e=null,this.computedKeyframes.delete(t),this.computedOptions.delete(t),this.keyframeEffects.delete(t);let i=this.targetIndexes.get(t);return this.targets.delete(i),this.targetIndexes.delete(t),this}remove(t){this.removeTarget(t);let e=new Set([].concat(this.targets.values()));this.options.target=[...e],this.options.targets=[],e.clear(),e=null;let i=this.getProgress(),s=this.is("running"),n=this.is("paused");return this.updateOptions(),s?this.play():n&&this.pause(),this.setProgress(i),this}on(t,e,i){return i=i??this,this.emitter?.on?.(t,e??i,i),this.emitter.getEvent("update").length>0&&(Bt.RUNNING.add(this),null==Bt.animationFrame&&Bt.requestFrame()),this}off(t,e,i){return i=i??this,this.emitter?.off?.(t,e??i,i),this}emit(t,...e){return this.emitter?.emit?.(t,...e),this}toJSON(){return this.options}get[Symbol.toStringTag](){return"Animate"}};let Wt=Bt;Wt.RUNNING=new Set,Wt.FRAME_RATE=60,Wt.FRAME_START_TIME=0,Wt.pauseOnPageHidden=!0;t.UIDCount=0;const Ht=document.createElement("div"),Jt=()=>{l(Ht.id)||(Ht.id="empty-tween-el-container",Ht.style.setProperty("display","none"),Ht.style.setProperty("contain","paint layout size"),document.body.appendChild(Ht));let e=document.createElement("div");return e.id="empty-animate-el-"+t.UIDCount++,e.style.setProperty("display","none"),Ht.appendChild(e),e};class te extends Wt{stop(){this.targets.forEach((t=>t?.remove?.())),super.stop()}}const ee=(e={})=>{let{easing:i,decimal:s,numPoints:n,opacity:a,...r}=Gt(e),o=c(Qt,r),l=i;if("string"==typeof i){let e=lt(i);l=Ut.includes(e)||["linear","steps","step-start","step-end"].includes(e)?Yt(i):t.EasingFunctionKeys.includes(e)?ut(i):i}return{..."function"==typeof l?Mt({opacity:[0,1],easing:i,decimal:s,numPoints:n}):{opacity:[0,1],easing:i},...o}};class ie extends te{constructor(){super(...arguments),this.updateListeners=new g}updateOptions(t={}){let e=Gt(t),i=this.targets.size>1?null:{target:Jt()},n=Object.assign({},ee(p(["target","targets"],e)),i);super.updateOptions(n);let a=p(Qt,e);try{this.updateListeners=this.updateListeners??new g,this.updateListeners.forEach(((t,e)=>{this.off("update",t),this.updateListeners.remove(e)}),this);let{target:t,targets:i}=e,n=[...new Set([...Lt(i),...Lt(t)])],r=n.length,o=this.targets.get(0),l=window.getComputedStyle(o);n.forEach(((t,i)=>{s(a,((s,n)=>{let a,o=t.getAttribute(n);this.on("update",a=()=>{let a,u=Number(l.getPropertyValue("opacity"));a="function"==typeof s?s(u,i,r,t):Et(u,Array.isArray(s)?s:[o,s],e.decimal),t.setAttribute(n,""+a)}),this.updateListeners.add(a)}))}),this)}catch(t){this?.stopLoop(),this?.emit?.("error",t)}return this}}const se=(t,e={})=>{const{grid:i,axis:s,from:n=0,easing:r,direction:o="normal"}=e,l=Array.isArray(t),u=l?t.length-1:null,h=parseFloat(l?t[0]:t),p=l?parseFloat(t[u]):0,{start:c=(l?h:0)}=e,m=a(l?t[u]:t)||0,f="function"==typeof r?r:ut(r),d="function"==typeof r?[]:ht(r);let g,y=[],b=0,E=n;return/from/i.test(n)&&(E=0),(t,e)=>{if(/center/i.test(n)&&(E=(e-1)/2),/last/i.test(n)&&(E=e-1),0==y.length){for(let t=0;t<e;t++)if(Array.isArray(i)){const e="center"!==n?E%i[0]:(i[0]-1)/2,a="center"!==n?Math.floor(E/i[0]):(i[1]-1)/2,r=e-t%i[0],o=a-Math.floor(t/i[0]);let l;l="x"===s?-r:"y"===s?-o:Math.sqrt(r*r+o*o),y.push(l)}else y.push(Math.abs(E-t));b=Math.max(...y),g=l?(p-h)/b:h,"function"==typeof f&&(y=y.map((t=>f(t/b,d)*b))),/reverse/i.test(o)&&y.reverse()}return c+g*(Math.round(100*y[t])/100)+m}},ne=(t,e)=>"string"==typeof t?/^\=/.test(t)?parseFloat(t.replace("=","")):parseFloat(t)+e:t+e;class ae{constructor(t={}){this.animateInstances=new g,this.timelineOffset=0,this.options={},this.initialOptions={},this.emitter=new qt,this.initialOptions=Object.assign({},Xt,Gt(t))}get totalDuration(){return Math.max(...this.animateInstances.values().map((t=>t.totalDuration)))}get maxDuration(){return Math.max(...this.animateInstances.values().map((t=>t.maxDuration)))}get minDelay(){return Math.min(...this.animateInstances.values().map((t=>t.minDelay)))}get maxSpeed(){return Math.min(...this.animateInstances.values().map((t=>t.maxSpeed)))}get maxEndDelay(){return Math.max(...this.animateInstances.values().map((t=>t.maxEndDelay)))}add(t={},e=0){let i,s=Object.assign({},Xt,this.initialOptions,t instanceof Wt?t.initialOptions:Gt(t)),n=this.totalDuration;if(Math.abs(n)!==1/0)if(/\</.test(e)){let t=this.animateInstances.last()?.totalDuration??0;Math.abs(t)!==1/0&&(s.timelineOffset=ne((e+"").replace(/\</,""),n-t))}else s.timelineOffset=ne(e,n);return s.autoplay=this.initialOptions.autoplay,s.persist=!1,t instanceof Wt?(i=t,i.updateOptions(s)):i=new Wt(s),this.animateInstances.add(i),this.updateTiming(),this}updateTiming(){if(this.animateInstances.values().length<=1)return this;let t=this.totalDuration;return Math.abs(t)==1/0?(console.warn('[Queue - @okikio/animate] individual Animate instances that are part of a Queue can\'t have Infinite totalDuration. You can\'t queue animations one after the other if one of the animations last for literally infinity. This issue may come from setting the "loop, duration, endDelay, delay, etc..." animation options to either Infinity (or for the loop option only, "true").'),this):(this.all((e=>{e.updateOptions({endDelay:t-(e.totalDuration-e.maxEndDelay)})})),this)}newPromise(){return this.promise=new Promise(((t,e)=>{this.emitter?.once?.("finish",(()=>t([this]))),this.emitter?.once?.("error",(t=>e(t)))})),this.promise}then(t,e){return t=t?.bind(this),e=e?.bind(this),this.promise?.then?.(t,e),this}catch(t){return t=t?.bind(this),this.promise?.catch?.(t),this}finally(t){return t=t?.bind(this),this.promise?.finally?.(t),this}all(t){return this.animateInstances.forEach(t),this}play(){return this.all((t=>t.play())),this}pause(){return this.all((t=>t.pause())),this}reverse(){return this.all((t=>t.reverse())),this}reset(){return this.all((t=>t.reset())),this}cancel(){return this.all((t=>t.cancel())),this}finish(){return this.all((t=>t.finish())),this}stop(){this.all((t=>t.stop())),this.animateInstances.clear(),this.animateInstances=null}getCurrentTime(){return Math.max(...this.animateInstances.values().map((t=>t.getCurrentTime())))}getProgress(){return Math.max(...this.animateInstances.values().map((t=>t.getCurrentTime())))}getSpeed(){return this.maxSpeed}getPlayState(){return this.animateInstances.get(0)?.getPlayState()}is(t){return this.animateInstances.get(0)?.is(t)}setCurrentTime(t){return this.all((e=>e.setCurrentTime(t))),this}setProgress(t){return this.all((e=>e.setCurrentTime(t))),this}setSpeed(t=1){return this.all((e=>e.setSpeed(t))),this}remove(t){let e=this.animateInstances.size;if(this.animateInstances.has(t)){let i=this.animateInstances.get(t),{totalDuration:s,timelineOffset:n}=i.totalDurationOptions,a=Number(s)-Number(n);for(let i=t;i<e;i++){let t=this.animateInstances.get(i);t.updateOptions({timelineOffset:t.timelineOffset-a})}return this.animateInstances.remove(t),this.updateTiming(),i}return null}on(t,e,i){return i=i??this,this.animateInstances.get(0)?.on?.(t,e??i,i),this}off(t,e,i){return i=i??this,this.animateInstances.get(0)?.off?.(t,e??i,i),this}emit(t,...e){return this.animateInstances.get(0)?.emit?.(t,...e),this}toJSON(){return this.options}get[Symbol.toStringTag](){return"Queue"}}t.ALL_TIMING_KEYS=Qt,t.Animate=Wt,t.AnimateAttributes=ie,t.ApplyCustomEasing=Mt,t.Back=Q,t.Bezier=it,t.Bounce=B,t.CSSArrValue=A,t.CSSCamelCase=xt,t.CSSPXDataType=Dt,t.CSSValue=O,t.CSSVarSupport=v,t.CSS_CACHE=P,t.Circ=$,t.ComplexEasingSyntax=lt,t.ComplexStrtoArr=bt,t.Cubic=U,t.CustomEasing=wt,t.CustomEasingOptions=St,t.DefaultAnimationOptions=Xt,t.DestroyableAnimate=te,t.EASINGS=Vt,t.EFFECTS={},t.EaseInOut=at,t.EaseOut=nt,t.EaseOutIn=rt,t.EasingDurationCache=J,t.EasingFunctions=ot,t.EasingKeys=Ut,t.EasingPts=At,t.Elastic=W,t.EmptyTweenElContainer=Ht,t.Expo=G,t.FUNCTION_SUPPORTED_TIMING_KEYS=Zt,t.GetEase=Yt,t.GetEasingFunction=ut,t.INTINITE_LOOP_LIMIT=1e4,t.KeyframeParse=d,t.NOT_FUNCTION_SUPPORTED_TIMING_KEYS=$t,t.ParseTransformableCSSKeyframes=It,t.ParseTransformableCSSProperties=Nt,t.Quad=V,t.Quart=Y,t.Queue=ae,t.Quint=X,t.Sine=Z,t.Spring=H,t.SpringEasing=(t,e={})=>{let i=St(e),{duration:s}=i;return kt(i),[wt(t,i),l(s)?s:i.duration]},t.StaggerCustomEasing=(t,e={})=>{let i=e.stagger??{};return(s,n)=>{let a=t.map(((e,a)=>{let r=t[Math.max(0,a-1)];return se([r,e],i)(s,n)}));return wt(a,e)}},t.Steps=et,t.TransformFunctionNames=Ct,t.TransformFunctions=Pt,t.TweenCache=Ot,t.UnitDEG=S,t.UnitDEGCSSValue=M,t.UnitLess=b,t.UnitLessCSSValue=k,t.UnitPX=E,t.UnitPXCSSValue=w,t.addCSSUnit=y,t.animate=(t={})=>new Wt(t),t.arrFill=Tt,t.camelCase=h,t.computeOption=_t,t.convertToDash=u,t.createEmptyEl=Jt,t.createTransformProperty=vt,t.createTransformValue=T,t.createTweenOptions=ee,t.easein=st,t.flatten=e,t.getEasingDuration=tt,t.getElements=Rt,t.getTargets=Lt,t.getUnit=a,t.interpolateColor=yt,t.interpolateComplex=Et,t.interpolateNumber=mt,t.interpolateString=gt,t.interpolateUsingIndex=dt,t.isEmpty=t=>{for(let e in t)return!1;return!0},t.isNumberLike=ft,t.isObject=i,t.isValid=l,t.limit=K,t.mapAnimationOptions=Kt,t.mapObject=s,t.omit=p,t.parseEasingParameters=ht,t.parseOffset=f,t.parseOptions=Gt,t.pick=c,t.queue=(t={})=>new ae(t),t.random=(t,e)=>Math.floor(Math.random()*(e-t+1))+t,t.registerEasingFunction=(e,i)=>{Object.assign(ot,{[e]:i}),t.EasingFunctionKeys=Object.keys(ot)},t.registerEasingFunctions=(...e)=>{Object.assign(ot,...e),t.EasingFunctionKeys=Object.keys(ot)},t.relativeTo=ne,t.scale=pt,t.stagger=se,t.toArr=o,t.toCSSVars=N,t.toFixed=ct,t.toRGBAArr=C,t.toStr=n,t.transformCSSVars=x,t.transformProperyNames=D,t.transpose=m,t.trim=r,t.tweenAttr=(t={})=>new ie(t),Object.defineProperty(t,"__esModule",{value:!0})}));
