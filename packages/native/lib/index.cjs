"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t={wrapperAttr:"wrapper",headers:[],preventSelfAttr:'prevent="self"',preventAllAttr:'prevent="all"',transitionAttr:"transition",timeout:2e3,maxPages:5,resizeDelay:100,onTransitionPreventClick:!0,cacheIgnore:!1,prefetchIgnore:!1,preventURLs:[],stickyScroll:!1,forceOnError:!0,ignoreHashAction:!1,transitions:[]},e=e=>Object.assign({...t},e),r=(t,e,r=!0)=>{let{prefix:i}=t,s=`data${i?"-"+i:""}-${t[e]}`;return r?`[${s}]`:s};class i{constructor(t){this.map=new Map(t)}getMap(){return this.map}get(t){return this.map.get(t)}keys(){return Array.from(this.map.keys())}values(){return Array.from(this.map.values())}set(t,e){return this.map.set(t,e),this}add(t){let e=this.size;return this.set(e,t),this}get size(){return this.map.size}get length(){return this.map.size}last(t=1){let e=this.keys()[this.size-t];return this.get(e)}delete(t){return this.map.delete(t)}remove(t){return this.map.delete(t),this}clear(){return this.map.clear(),this}has(t){return this.map.has(t)}entries(){return this.map.entries()}forEach(t,e){return this.map.forEach(t,e),this}[Symbol.iterator](){return this.entries()}}const s=(t,e,...r)=>{t.forEach((t=>{t[e](...r)}))};class n{constructor(){}install(){}register(t,e){return this.manager=t,this.app=t.app,this.config=t.config,this.emitter=t.emitter,this.key=e,this.install(),this}uninstall(){}unregister(){this.uninstall(),this.manager.remove(this.key),this.key=null,this.manager=null,this.app=null,this.config=null,this.emitter=null}}class o extends i{constructor(t){super(),this.app=t,this.config=t.config,this.emitter=t.emitter}set(t,e){return super.set(t,e),e.register(this,t),this}}const a=(t=window.location.href)=>t instanceof URL?t:new URL(t,window.location.origin),h=t=>{let e=a(t);return`${e.pathname}${e.hash}`},l=t=>a(t).toString().replace(/(\/#.*|\/|#.*)$/,""),c=(t,e)=>l(t)===l(e);class u extends n{init(){}boot(){this.initEvents()}initEvents(){}stopEvents(){}stop(){this.stopEvents(),this.unregister()}}class p extends o{constructor(t){super(t)}init(){return s(this,"init"),this}boot(){return s(this,"boot"),this}stop(){return s(this,"stop"),this}}const g=(t=window.scrollX,e=window.scrollY)=>({x:t,y:e}),d=(t={url:h(a()),index:0,transition:"default",data:{scroll:g(),trigger:"HistoryManager"}})=>t;const f=(t,e,r)=>{let i=[r,"",h(e.url)];if(window.history)switch(t){case"push":window.history.pushState.apply(window.history,i);break;case"replace":window.history.replaceState.apply(window.history,i)}};function m(t,e){void 0===e&&(e={});for(var r=function(t){for(var e=[],r=0;r<t.length;){var i=t[r];if("*"!==i&&"+"!==i&&"?"!==i)if("\\"!==i)if("{"!==i)if("}"!==i)if(":"!==i)if("("!==i)e.push({type:"CHAR",index:r,value:t[r++]});else{var s=1,n="";if("?"===t[a=r+1])throw new TypeError('Pattern cannot start with "?" at '+a);for(;a<t.length;)if("\\"!==t[a]){if(")"===t[a]){if(0==--s){a++;break}}else if("("===t[a]&&(s++,"?"!==t[a+1]))throw new TypeError("Capturing groups are not allowed at "+a);n+=t[a++]}else n+=t[a++]+t[a++];if(s)throw new TypeError("Unbalanced pattern at "+r);if(!n)throw new TypeError("Missing pattern at "+r);e.push({type:"PATTERN",index:r,value:n}),r=a}else{for(var o="",a=r+1;a<t.length;){var h=t.charCodeAt(a);if(!(h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||95===h))break;o+=t[a++]}if(!o)throw new TypeError("Missing parameter name at "+r);e.push({type:"NAME",index:r,value:o}),r=a}else e.push({type:"CLOSE",index:r,value:t[r++]});else e.push({type:"OPEN",index:r,value:t[r++]});else e.push({type:"ESCAPED_CHAR",index:r++,value:t[r++]});else e.push({type:"MODIFIER",index:r,value:t[r++]})}return e.push({type:"END",index:r,value:""}),e}(t),i=e.prefixes,s=void 0===i?"./":i,n="[^"+w(e.delimiter||"/#?")+"]+?",o=[],a=0,h=0,l="",c=function(t){if(h<r.length&&r[h].type===t)return r[h++].value},u=function(t){var e=c(t);if(void 0!==e)return e;var i=r[h],s=i.type,n=i.index;throw new TypeError("Unexpected "+s+" at "+n+", expected "+t)},p=function(){for(var t,e="";t=c("CHAR")||c("ESCAPED_CHAR");)e+=t;return e};h<r.length;){var g=c("CHAR"),d=c("NAME"),f=c("PATTERN");if(d||f){var m=g||"";-1===s.indexOf(m)&&(l+=m,m=""),l&&(o.push(l),l=""),o.push({name:d||a++,prefix:m,suffix:"",pattern:f||n,modifier:c("MODIFIER")||""})}else{var v=g||c("ESCAPED_CHAR");if(v)l+=v;else if(l&&(o.push(l),l=""),c("OPEN")){m=p();var y=c("NAME")||"",E=c("PATTERN")||"",A=p();u("CLOSE"),o.push({name:y||(E?a++:""),pattern:y&&!E?n:E,prefix:m,suffix:A,modifier:c("MODIFIER")||""})}else u("END")}}return o}function w(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function v(t){return t&&t.sensitive?"":"i"}function y(t,e,r){return function(t,e,r){void 0===r&&(r={});for(var i=r.strict,s=void 0!==i&&i,n=r.start,o=void 0===n||n,a=r.end,h=void 0===a||a,l=r.encode,c=void 0===l?function(t){return t}:l,u="["+w(r.endsWith||"")+"]|$",p="["+w(r.delimiter||"/#?")+"]",g=o?"^":"",d=0,f=t;d<f.length;d++){var m=f[d];if("string"==typeof m)g+=w(c(m));else{var y=w(c(m.prefix)),E=w(c(m.suffix));if(m.pattern)if(e&&e.push(m),y||E)if("+"===m.modifier||"*"===m.modifier){var A="*"===m.modifier?"?":"";g+="(?:"+y+"((?:"+m.pattern+")(?:"+E+y+"(?:"+m.pattern+"))*)"+E+")"+A}else g+="(?:"+y+"("+m.pattern+")"+E+")"+m.modifier;else g+="("+m.pattern+")"+m.modifier;else g+="(?:"+y+E+")"+m.modifier}}if(h)s||(g+=p+"?"),g+=r.endsWith?"(?="+u+")":"$";else{var x=t[t.length-1],T="string"==typeof x?p.indexOf(x[x.length-1])>-1:void 0===x;s||(g+="(?:"+p+"(?="+u+"))?"),T||(g+="(?="+p+"|"+u+")")}return new RegExp(g,v(r))}(m(t,r),e,r)}function E(t,e,r){return t instanceof RegExp?function(t,e){if(!e)return t;for(var r=/\((?:\?<(.*?)>)?(?!\?)/g,i=0,s=r.exec(t.source);s;)e.push({name:s[1]||i++,prefix:"",suffix:"",modifier:"",pattern:""}),s=r.exec(t.source);return t}(t,e):Array.isArray(t)?function(t,e,r){var i=t.map((function(t){return E(t,e,r).source}));return new RegExp("(?:"+i.join("|")+")",v(r))}(t,e,r):y(t,e,r)}const A=new DOMParser;class x extends n{constructor(t=a(),e=document){super(),this.url=a(t),"string"==typeof e?this.data=e:this.dom=e||document}async build(){if(this.dom instanceof Node||(this.dom=A.parseFromString(this.data,"text/html")),!(this.body instanceof Node)){let{title:t,head:e,body:r}=this.dom;this.title=t,this.head=e,this.body=r,this.wrapper=this.body.querySelector(this.wrapperAttr)}}install(){this.wrapperAttr=r(this.config,"wrapperAttr")}uninstall(){this.url=null,this.title=null,this.head=null,this.body=null,this.dom=null,this.wrapper=null,this.data=null,this.wrapperAttr=null}}const T=(t,e)=>{if("boolean"==typeof e)return e;let r=[];return!e.every((e=>null==E(e,r,{start:!1,end:!1}).exec(t)))},R=(t,e=window.location.hash)=>{try{let t="#"==e[0]?e:a(e).hash;if(t.length>1){let e=document.getElementById(t.slice(1));if(e){let{left:t,top:r}=e.getBoundingClientRect(),i=window.scrollX,s=window.scrollY;return g(t+i,r+s)}}}catch(t){console.warn("[hashAction] error",t)}return t??g(0,0)},P={name:"replace"};const b=({callback:t=(()=>{}),scope:e=null,name:r="event"})=>({callback:t,scope:e,name:r});class N extends i{constructor(t="event"){super(),this.name=t}}const O=t=>"object"==typeof t&&!Array.isArray(t)&&"function"!=typeof t;class _ extends i{constructor(){super()}getEvent(t){let e=this.get(t);return e instanceof N?e:(this.set(t,new N(t)),this.get(t))}newListener(t,e,r){let i=this.getEvent(t);return i.add(b({name:t,callback:e,scope:r})),i}on(t,e,r){if(null==t||null==t)return this;"string"==typeof t&&(t=t.trim().split(/\s+/));let i,s,n=O(t),o=n?e:r;return n||(s=e),Object.keys(t).forEach((e=>{i=n?e:t[e],n&&(s=t[e]),this.newListener(i,s,o)}),this),this}removeListener(t,e,r){let i=this.get(t);if(i instanceof N&&e){let s=b({name:t,callback:e,scope:r});i.forEach(((t,e)=>{if(t.callback===s.callback&&t.scope===s.scope)return i.remove(e)}))}return i}off(t,e,r){if(null==t||null==t)return this;"string"==typeof t&&(t=t.trim().split(/\s+/));let i,s,n=O(t),o=n?e:r;return n||(s=e),Object.keys(t).forEach((e=>{i=n?e:t[e],n&&(s=t[e]),"function"==typeof s?this.removeListener(i,s,o):this.remove(i)}),this),this}once(t,e,r){if(null==t||null==t)return this;"string"==typeof t&&(t=t.trim().split(/\s+/));let i=O(t);return Object.keys(t).forEach((s=>{let n=i?s:t[s],o=i?t[s]:e,a=i?e:r,h=(...t)=>{o.apply(a,t),this.removeListener(n,h,a)};this.newListener(n,h,a)}),this),this}emit(t,...e){return null==t||null==t||("string"==typeof t&&(t=t.trim().split(/\s+/)),t.forEach((t=>{let r=this.get(t);r instanceof N&&r.forEach((t=>{let{callback:r,scope:i}=t;r.apply(i,e)}))}),this)),this}clear(){return s(this,"clear"),super.clear(),this}}exports.AdvancedManager=o,exports.App=class{constructor(t={}){this.canResize=!0,this.canScroll=!0,this._resize=this._resize.bind(this),this._scroll=this._scroll.bind(this),this._ready=this._ready.bind(this),this.register(t)}register(t={}){return this.config=e(t),this.emitter=new _,this.services=new p(this),this}_ready(){document.removeEventListener("DOMContentLoaded",this._ready),window.removeEventListener("load",this._ready),this.emitter.emit("READY ready")}_resize(){if(this.canResize){let t;this.canResize=!1,window.requestAnimationFrame((()=>{this.emitter.emit("RESIZE resize"),t=window.setTimeout((()=>{this.canResize=!0,t=window.clearTimeout(t)}),this.config.resizeDelay)}))}}_scroll(){this.canScroll&&(this.canScroll=!1,window.requestAnimationFrame((()=>{this.emitter.emit("SCROLL scroll"),this.canScroll=!0})))}get(t){return this.services.get(t)}set(t,e){return this.services.set(t,e),this}add(t){return this.services.add(t),this}boot(){return document.addEventListener("DOMContentLoaded",this._ready),window.addEventListener("load",this._ready),window.addEventListener("resize",this._resize,{passive:!0}),window.addEventListener("scroll",this._scroll,{passive:!0}),this.services.init(),this.services.boot(),this}stop(){return window.removeEventListener("resize",this._resize),window.removeEventListener("scroll",this._scroll),this.services.stop(),this.emitter.clear(),this}on(t,e){return this.emitter.on(t,e,this),this}off(t,e){return this.emitter.off(t,e,this),this}emit(t,...e){return this.emitter.emit(t,...e),this}},exports.CONFIG_DEFAULTS=t,exports.HistoryManager=class extends u{constructor(){super(...arguments),this.pointer=-1}init(){this.states=[];let t=d();this.add(t,"replace")}get(t){return this.states[t]}add(t,e="push"){let r=d(t),i=this.length;this.states.push({...r}),this.pointer=i;let s={index:this.pointer,states:[...this.states]};return f(e,r,s),this}remove(t){return t?this.states.splice(t,1):this.states.pop(),this.pointer--,this}replace(t){return this.states=t,this}set(t,e){return this.states[t]=e}get current(){return this.get(this.pointer)}get last(){return this.get(this.length-1)}get previous(){return this.pointer<1?null:this.get(this.pointer-1)}get length(){return this.states.length}},exports.Manager=i,exports.ManagerItem=n,exports.PARSER=A,exports.PJAX=class extends u{install(){super.install(),this.preventURLs=this.config.preventURLs,this.prefetchIgnore=this.config.prefetchIgnore,this.onTransitionPreventClick=this.config.onTransitionPreventClick,this.stickyScroll=this.config.stickyScroll,this.forceOnError=this.config.forceOnError,this.ignoreHashAction=this.config.ignoreHashAction}transitionStart(){this.isTransitioning=!0}transitionStop(){this.isTransitioning=!1}init(){this.onHover=this.onHover.bind(this),this.onClick=this.onClick.bind(this),this.onStateChange=this.onStateChange.bind(this)}boot(){super.boot()}getTransitionName(t){if(!t||!t.getAttribute)return null;let e=t.getAttribute(r(this.config,"transitionAttr",!1));return"string"==typeof e?e:null}validLink(t,e,i){let s=!window.history.pushState,n=!t||!i,o=e.metaKey||e.ctrlKey||e.shiftKey||e.altKey,l=t.hasAttribute("target")&&"_blank"===t.target,c=t.protocol!==location.protocol||t.hostname!==location.hostname,u="string"==typeof t.getAttribute("download"),p=t.matches(r(this.config,"preventSelfAttr")),g=Boolean(t.closest(r(this.config,"preventAllAttr"))),d=T(a(i).pathname,this.preventURLs),f=h(a())===h(a(i));return!(n||s||o||l||c||u||p||g||d||f)}getHref(t){return t&&t.tagName&&"a"===t.tagName.toLowerCase()&&"string"==typeof t.href?t.href:null}getLink(t){let e=t.target,r=this.getHref(e);for(;e&&!r;)e=e.parentNode,r=this.getHref(e);if(e&&this.validLink(e,t,r))return e}onClick(t){let e=this.getLink(t);if(!e)return;if(this.isTransitioning&&this.onTransitionPreventClick)return t.preventDefault(),void t.stopPropagation();let r=this.getHref(e);this.emitter.emit("ANCHOR_CLICK CLICK",t),this.go({href:r,trigger:e,event:t})}getDirection(t){return Math.abs(t)>1?t>0?"forward":"back":0===t?"popstate":t>0?"back":"forward"}force(t){window.location.assign(t)}go({href:t,trigger:e="HistoryManager",event:r}){if(this.isTransitioning&&!this.onTransitionPreventClick||!(this.manager.has("TransitionManager")&&this.manager.has("HistoryManager")&&this.manager.has("PageManager")))return void this.force(t);const i=this.manager.get("HistoryManager");let s,n=g(0,0),o=i.current,a=o.url;if(!c(a,t)){if(r&&r.state){this.emitter.emit("POPSTATE",r);let{state:t}=r,{index:a}=t,h=o.index-a;i.replace(t.states),i.pointer=a;let l=i.get(a);s=l.transition,n=l.data.scroll,e=this.getDirection(h),this.emitter.emit("back"===e?"POPSTATE_BACK":"POPSTATE_FORWARD",r)}else{s=this.getTransitionName(e),n=g();let o=d({url:t,transition:s,data:{scroll:n}});!this.stickyScroll&&(n=g(0,0)),i.add(o),this.emitter.emit("HISTORY_NEW_ITEM",r)}return r&&(r.stopPropagation(),r.preventDefault()),this.emitter.emit("GO",r),this.load({oldHref:a,href:t,trigger:e,transitionName:s,scroll:n})}}async load({oldHref:t,href:e,trigger:r,transitionName:i="default",scroll:s={x:0,y:0}}){try{const n=this.manager.get("TransitionManager"),o=this.manager.get("PageManager");let a,h,l=this.ignoreHashAction;this.emitter.emit("NAVIGATION_START",{oldHref:t,href:e,trigger:r,transitionName:i,scroll:s}),n.has(i)||(console.log(`[PJAX] transition name "${i}" doesn't exist, switching to the "default" transition`),i="default");try{this.transitionStart(),this.emitter.emit("PAGE_LOADING",{href:e,oldHref:t,trigger:r,scroll:s}),h=await o.load(t),a=await o.load(e),this.emitter.emit("PAGE_LOAD_COMPLETE",{newPage:a,oldPage:h,trigger:r,scroll:s}),h.dom instanceof Element||h.build(),a.build()}catch(t){console.warn("[PJAX] Page load error",t)}try{s=(await n.start(i,{oldPage:h,newPage:a,trigger:r,scroll:s,ignoreHashAction:l})).scroll}catch(t){console.warn("[PJAX] Transition error",t)}this.emitter.emit("NAVIGATION_END",{oldPage:h,newPage:a,trigger:r,transitionName:i,scroll:s})}catch(t){this.forceOnError?this.force(e):console.warn(t)}finally{this.transitionStop()}}onHover(t){let e=this.getLink(t);if(!e||!this.manager.has("PageManager"))return;const r=this.manager.get("PageManager");let i=a(this.getHref(e)),s=i.pathname;if(this.emitter.emit("ANCHOR_HOVER HOVER",t),!T(i.pathname,this.prefetchIgnore)&&(!r.has(s)||T(s,r.cacheIgnore)))try{r.load(i),this.emitter.emit("PREFETCH",t)}catch(t){console.warn("[PJAX] Prefetch error",t)}}onStateChange(t){this.go({href:window.location.href,trigger:"popstate",event:t})}initEvents(){!0!==this.prefetchIgnore&&(document.addEventListener("mouseover",this.onHover),document.addEventListener("touchstart",this.onHover)),document.addEventListener("click",this.onClick),window.addEventListener("popstate",this.onStateChange)}stopEvents(){!0!==this.prefetchIgnore&&(document.removeEventListener("mouseover",this.onHover),document.removeEventListener("touchstart",this.onHover)),document.removeEventListener("click",this.onClick),window.removeEventListener("popstate",this.onStateChange)}},exports.Page=x,exports.PageManager=class extends u{constructor(){super(),this.loading=new i}install(){this.pages=new o(this.app),this.cacheIgnore=this.config.cacheIgnore;let t=a().pathname;this.set(t,new x),t=null}get(t){return this.pages.get(t)}add(t){return this.pages.add(t),this}set(t,e){return this.pages.set(t,e),this}remove(t){return this.pages.remove(t),this}has(t){return this.pages.has(t)}clear(){return this.pages.clear(),this}get size(){return this.pages.size}keys(){return this.pages.keys()}async load(t=a()){let e,r,i=a(t),s=i.pathname;if(this.has(s)&&!T(s,this.cacheIgnore))return e=this.get(s),Promise.resolve(e);this.loading.has(s)?r=this.loading.get(s):(r=this.request(s),this.loading.set(s,r));let n=await r;if(this.loading.remove(s),e=new x(i,n),this.set(s,e),this.size>this.config.maxPages){let t=a(),e=this.keys(),r=c(t,e[0])?e[1]:e[0],i=this.get(r);i.unregister(),i=null,e=null,t=null,r=null}return e}async request(t){const e=new Headers(this.config.headers),r=window.setTimeout((()=>{window.clearTimeout(r);const e=new Error("Request Timed Out!");throw this.emitter.emit("TIMEOUT_ERROR",e,t),e}),this.config.timeout);try{let i=await fetch(t,{mode:"same-origin",method:"GET",headers:e,cache:"default",credentials:"same-origin"});if(window.clearTimeout(r),i.status>=200&&i.status<300)return await i.text();const s=new Error(i.statusText||""+i.status);throw this.emitter.emit("REQUEST_ERROR",s,t),s}catch(t){throw window.clearTimeout(r),t}}},exports.Router=class extends u{constructor(t=[]){super(),this.routes=new i;for(let e of t)this.add(e)}add({path:t,method:e}){let r=this.parse(t);return this.routes.set(r,e),this}parsePath(t){if("string"==typeof t||t instanceof RegExp||Array.isArray(t))return E(t,[],{start:!1,end:!1});if("boolean"==typeof t)return t&&/.*/;throw"[Router] only regular expressions, strings, booleans and arrays of regular expressions and strings are accepted as paths."}isPath(t){return"string"==typeof t||t instanceof RegExp||"boolean"==typeof t||Array.isArray(t)}parse(t){let e=t,r={from:/.*/,to:/.*/};if(this.isPath(t))r={from:!0,to:t};else{if(!this.isPath(e.from)||!this.isPath(e.to))throw"[Router] path is neither a string, regular expression, or a { from, to } object.";r=Object.assign({},r,e)}let{from:i,to:s}=r;return{from:this.parsePath(i),to:this.parsePath(s)}}route(){if(this.manager.has("HistoryManager")){let t=this.manager.get("HistoryManager"),e=h(a((t.length>1?t.previous:t.current).url)),r=h(a());this.routes.forEach(((t,i)=>{let s=i.from,n=i.to;if("boolean"==typeof s&&"boolean"==typeof n)throw`[Router] path ({ from: ${s}, to: ${n} }) is not valid, remember paths can only be strings, regular expressions, or a boolean; however, both the from and to paths cannot be both booleans.`;let o=s,a=n;s instanceof RegExp&&s.test(e)&&(o=s.exec(e)),n instanceof RegExp&&n.test(r)&&(a=n.exec(r)),(Array.isArray(a)&&Array.isArray(o)||Array.isArray(a)&&0==o&&!n.test(e)||Array.isArray(o)&&0==a&&!s.test(r))&&t({from:o,to:a,path:{from:e,to:r}})}))}else console.warn("[Route] HistoryManager is missing.")}initEvents(){this.emitter.on("READY",this.route,this),this.emitter.on("CONTENT_REPLACED",this.route,this)}stopEvents(){this.emitter.off("READY",this.route,this),this.emitter.off("CONTENT_REPLACED",this.route,this)}},exports.Service=u,exports.ServiceManager=p,exports.TRANSITION_REPLACE=P,exports.TransitionManager=class extends u{constructor(t){super(),this._arg=t}install(){super.install();let t=this._arg&&this._arg.length?this._arg:this.config.transitions;this.transitions=new i([["default",P],["replace",P]].concat(t))}get(t){return this.transitions.get(t)}set(t,e){return this.transitions.set(t,e),this}add(t){return this.transitions.add(t),this}has(t){return this.transitions.has(t)}async start(t,e){let i=this.transitions.get(t),{oldPage:s,newPage:n,ignoreHashAction:o,trigger:a}=e;if(this.emitter.emit("TRANSITION_START",{transitionName:t,...e}),!("wrapper"in s)||!("wrapper"in n))throw`[TransitionManager] either oldPage or newPage aren't instances of the Page Class.\n ${{newPage:n,oldPage:s}}`;document.title=""+n.title;let h=s.wrapper,l=n.wrapper;if(!(h instanceof Node&&l instanceof Node))throw`[TransitionManager] the wrapper from the ${l instanceof Node?"current":"next"} page cannot be found. The wrapper must be an element that has the attribute ${r(this.config,"wrapperAttr")}.`;return i.init&&i?.init(e),this.emitter.emit("BEFORE_TRANSITION_OUT",e),i.out&&await new Promise((t=>{i.out.call(i,{...e,from:s,done:t})?.then(t)})),this.emitter.emit("AFTER_TRANSITION_OUT",e),await new Promise((t=>{h.insertAdjacentElement("beforebegin",l),this.emitter.emit("CONTENT_INSERT",e),t()})),await new Promise((t=>{h.remove(),h=null,l=null,this.emitter.emit("CONTENT_REPLACED",e),!o&&!/back|popstate|forward/.test(a)&&(e.scroll=R(e.scroll)),t()})),this.emitter.emit("BEFORE_TRANSITION_IN",e),i.in&&await new Promise((t=>{i.in.call(i,{...e,from:s,to:n,done:t})?.then(t)})),this.emitter.emit("AFTER_TRANSITION_IN",e),i.manualScroll||(!o&&!/back|popstate|forward/.test(a)&&(e.scroll=R(e.scroll)),window.scroll(e.scroll.x,e.scroll.y)),this.emitter.emit("TRANSITION_END",{transitionName:t,...e}),e}},exports.changeState=f,exports.clean=l,exports.equal=c,exports.getHash=t=>a(t).hash.slice(1),exports.getHashedPath=h,exports.hashAction=R,exports.ignoreURLs=T,exports.methodCall=s,exports.newConfig=e,exports.newCoords=g,exports.newState=d,exports.newURL=a,exports.toAttr=r;
